{% extends "layouts/main.html" %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/tag/macro.njk" import govukTag %}
{% from "govuk/components/breadcrumbs/macro.njk" import govukBreadcrumbs %}

{% set pageName = product.Name %}
{% set pageDescription = product.Description or "Product information" %}
{% set nav = 'products' %}
{% set showNav = true %}

{% block main %}

    <div class="dfe-masthead dfe-masthead--with-links">
        <div class="govuk-width-container">
            <div class="govuk-grid-row">
                <div class="govuk-grid-column-full">
                    <a href="/products" class="govuk-back-link">Back to products</a>
                    <h1 class="govuk-heading-l dfe-masthead--title">
                        {{ pageName }}
                    </h1>
                    <table class="govuk-table">
                        <thead class="govuk-table__head">
                            <tr class="govuk-table__row">
                                <th class="govuk-table__header govuk-!-width-one-quarter">ID</th>
                                <th class="govuk-table__header govuk-!-width-one-quarter">Phase</th>
                                <th class="govuk-table__header govuk-!-width-one-quarter">Business area</th>
                                <th class="govuk-table__header govuk-!-width-one-quarter">Contacts</th>
                            </tr>
                        </thead>
                        <tbody class="govuk-table__body">
                            <tr class="govuk-table__row">
                                <td class="govuk-table__cell"><span class="govuk-visually-hidden">UniqueID: </span><span title="{{ product.id }}">{{ product.id | truncate(6) }}</span></td>
                                <td class="govuk-table__cell"><span class="govuk-visually-hidden">Phase: </span>  {% if product.phase %}
                            {{ govukTag({
                        text: product.phase,
                        classes: "govuk-tag--blue"
                    }) }}
                        {% endif %}</td>
                                <td class="govuk-table__cell"><span class="govuk-visually-hidden">Business area: </span>{{ product['Parent'] }}</td>
                                <td class="govuk-table__cell"><a href="/product/{{ product.id }}#contacts" class="govuk-link">{{ contacts | length }} contacts</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="govuk-width-container">
        <main class="govuk-main-wrapper" id="main-content" role="main"{% if mainClasses %} class="{{ mainClasses }}"{% endif %}>

            <div class="govuk-grid-row">

                <div class="govuk-grid-column-one-third">
                    <nav aria-label="Components Menu" class="dfe-vertical-nav">
                        <button type="button" class="dfe-vertical-nav__toggle dfe-js-vertical-nav-toggle" aria-controls="side-navigation" hidden="" aria-expanded="false">
    Product navigation
  </button>
                        <ul class="dfe-vertical-nav__section" id="side-navigation">

                            <li class="dfe-vertical-nav__section-item dfe-vertical-nav__section-item--current">
                                <a class="dfe-vertical-nav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="/product/{{ product.id }}">Overview</a>
                            </li>
                            <li class="dfe-vertical-nav__section-item ">
                                <a class="dfe-vertical-nav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="/product/{{ product.id }}/categories">Categories</a>
                            </li>

                        </ul>
                    </nav>
                </div>

                <div class="govuk-grid-column-two-thirds">

                    <h2 class="govuk-heading-m">Description</h2>
                    {% if product.Description %}
                       <pre class="govuk-body" style="white-space: pre-wrap; word-break: break-word; max-width: 100%;">{{ product.Description }}</pre>
                    {% else %}
                        <p class="govuk-body">No description available</p>
                    {% endif %}

                  
               
                    {{ govukSummaryList({
                rows: summaryRows
            }) }}

                           <h2 class="govuk-heading-m" id="contacts">Responsibilities and contacts</h2>

                     {% if contacts.length > 0 %}
                         {% set contactRows = [] %}
                         {% for contact in contacts %}
                             {% set contactRows = (contactRows.push({
                                 key: {
                                     text: contact.role
                                 },
                                 value: {
                                     html: '<a href="mailto:' + contact.email + '" class="govuk-link" rel="noopener noreferrer">' + contact.name + '</a>' if contact.email else contact.name
                                 }
                             }), contactRows) %}
                         {% endfor %}

                         {{ govukSummaryList({
                             rows: contactRows
                         }) }}
                     {% else %}
                         <p class="govuk-body">No contact information available.</p>
                     {% endif %}

                </div>

              
            </div>
        </main>
    </div>
{% endblock %}